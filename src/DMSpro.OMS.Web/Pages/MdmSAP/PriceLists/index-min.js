$((function(){let e=abp.localization.getResource("OMS"),t=dMSpro.oMS.mdmSapService.priceLists.priceList,i=dMSpro.oMS.mdmSapService.priceListByItems.priceListByItem,o=dMSpro.oMS.mdmSapService.items.item,a=(new DevExpress.data.CustomStore({key:"id",load(e){const t=$.Deferred(),i={};return requestOptions.forEach((t=>{t in e&&isNotEmpty(e[t])&&(i[t]=JSON.stringify(e[t]))})),o.getListDevExtreme(i).done((e=>{t.resolve(e.data,{totalCount:e.totalCount,summary:e.summary,groupCount:e.groupCount})})),t.promise()},byKey:function(e){if(0==e)return null;let t=new $.Deferred;return o.get(e).done((e=>{t.resolve(e)})),t.promise()}}),new DevExpress.data.CustomStore({key:"id",load(e){const i=$.Deferred(),o={};return requestOptions.forEach((t=>{t in e&&isNotEmpty(e[t])&&(o[t]=JSON.stringify(e[t]))})),t.getListDevExtreme(o).done((e=>{i.resolve(e.data,{totalCount:e.totalCount,summary:e.summary,groupCount:e.groupCount})})),i.promise()},byKey:function(e){if(0==e)return null;let i=new $.Deferred;return t.get(e).done((e=>{i.resolve(e)})),i.promise()}})),r=new DevExpress.data.CustomStore({key:"id",load(e){const t=$.Deferred(),o={};return requestOptions.forEach((t=>{t in e&&isNotEmpty(e[t])&&(o[t]=JSON.stringify(e[t]))})),i.getListDevExtreme(o).done((e=>{t.resolve(e.data,{totalCount:e.totalCount,summary:e.summary,groupCount:e.groupCount})})),t.promise()},byKey:function(e){if(0==e)return null;let t=new $.Deferred;return i.get(e).done((e=>{t.resolve(e)})),t.promise()}});new DevExpress.data.CustomStore({key:"id",useDefaultSearch:!0,load(e){const i=$.Deferred(),o={};return requestOptions.forEach((t=>{t in e&&isNotEmpty(e[t])&&(o[t]=JSON.stringify(e[t]))})),t.getListDevextremes(o).done((e=>{i.resolve(e.data,{totalCount:e.totalCount,summary:e.summary,groupCount:e.groupCount})})),i.promise()},byKey:function(e){if(0==e)return null;let i=new $.Deferred;return t.get(e).done((e=>{i.resolve(e)})),i.promise()}});const n=[{id:0,text:e("EntityFieldValue:MDMService:PriceList:ArithmeticOperation:ADD")},{id:1,text:e("EntityFieldValue:MDMService:PriceList:ArithmeticOperation:SUBTRACT")},{id:2,text:e("EntityFieldValue:MDMService:PriceList:ArithmeticOperation:MULTIPLICATION")},{id:3,text:e("EntityFieldValue:MDMService:PriceList:ArithmeticOperation:DIVISION")}];$("#gridPriceLists").dxDataGrid({key:"id",dataSource:a,remoteOperations:!0,showRowLines:!0,showBorders:!0,cacheEnabled:!0,allowColumnReordering:!0,rowAlternationEnabled:!0,allowColumnResizing:!0,columnResizingMode:"widget",filterRow:{visible:!0},groupPanel:{visible:!0},searchPanel:{visible:!0},columnChooser:{enabled:!0,mode:"select"},columnFixing:{enabled:!0},export:{enabled:!0},onExporting(e){if("xlsx"===e.format){const t=new ExcelJS.Workbook,i=t.addWorksheet("Data");DevExpress.excelExporter.exportDataGrid({component:e.component,worksheet:i,autoFilterEnabled:!0}).then((()=>{t.xlsx.writeBuffer().then((e=>{saveAs(new Blob([e],{type:"application/octet-stream"}),"PriceLists.xlsx")}))})),e.cancel=!0}},headerFilter:{visible:!0},paging:{enabled:!0,pageSize:pageSize},pager:{visible:!0,showPageSizeSelector:!0,allowedPageSizes:allowedPageSizes,showInfo:!0,showNavigationButtons:!0},toolbar:{items:["addRowButton","columnChooserButton","exportButton","searchPanel"]},columns:[{type:"buttons",buttons:[],caption:e("Actions"),name:"Actions",fixedPosition:"left"},{dataField:"priceListCode",caption:e("EntityFieldName:MDMService:PriceList:Code"),validationRules:[{type:"required"},{type:"pattern",pattern:"^[a-zA-Z0-9]{1,20}$",message:e("ValidateError:Code")}],cellTemplate:(e,t,i)=>$("<div />").text(t.value).css("color",t.data.isBase?"#1d4ed8":"")},{dataField:"priceListName",caption:e("EntityFieldName:MDMService:PriceList:Name"),validationRules:[{type:"required"}]},{dataField:"validFor",caption:e("EntityFieldName:MDMService:PriceList:Active"),calculateCellValue:e=>"Y"==e.validFor,cellTemplate(e,t){$('<div class="text-center">').append($("Y"==t.data.validFor?'<i class="fa fa-check" style="color:#34b233"></i>':'<i class= "fa fa-times" style="color:red"></i>')).appendTo(e)}},{caption:e("EntityFieldName:MDMService:PriceList:BasePriceList"),dataField:"basePriceListCode"},{caption:e("EntityFieldName:MDMService:PriceList:ArithmeticOperation"),calculateCellValue:e=>e.arithmeticOperation||2,lookup:{dataSource:n,valueExpr:"id",displayExpr:"text"}},{dataField:"factor",caption:e("EntityFieldName:MDMService:PriceList:ArithmeticFactor"),dataType:"number",editorOptions:{min:0}},{dataField:"isGrossPrice",caption:"Price Mode",cellTemplate(e,t){$('<div class="text-center">').append($(t.value?'<i class="fa fa-check" style="color:#34b233"></i>':'<i class= "fa fa-times" style="color:red"></i>')).appendTo(e)}}],masterDetail:{enabled:!0,template(t,i){const o=i.data;$("<div>").dxDataGrid({dataSource:{store:r,filter:["priceListCode","=",o.priceListCode]},key:"id",editing:{mode:"row",allowUpdating:!1,useIcons:!0,texts:{editRow:e("Edit")}},remoteOperations:!0,showRowLines:!0,showBorders:!0,cacheEnabled:!0,allowColumnReordering:!0,rowAlternationEnabled:!0,allowColumnResizing:!0,columnResizingMode:"widget",filterRow:{visible:!0},groupPanel:{visible:!0},searchPanel:{visible:!0},columnChooser:{enabled:!0,mode:"select"},columnFixing:{enabled:!0},export:{enabled:!0},onExporting(e){const t=new ExcelJS.Workbook,i=t.addWorksheet("Data");DevExpress.excelExporter.exportDataGrid({component:e.component,worksheet:i,autoFilterEnabled:!0}).then((()=>{t.xlsx.writeBuffer().then((e=>{saveAs(new Blob([e],{type:"application/octet-stream"}),"PriceListByItem.xlsx")}))})),e.cancel=!0},headerFilter:{visible:!0},paging:{enabled:!0,pageSize:pageSize},pager:{visible:!0,showPageSizeSelector:!0,allowedPageSizes:allowedPageSizes,showInfo:!0,showNavigationButtons:!0},toolbar:{items:["addRowButton","groupPanel","columnChooserButton","exportButton","searchPanel"]},columns:[{type:"buttons",buttons:["edit"],caption:e("Actions"),fixedPosition:"left"},{caption:e("EntityFieldName:MDMService:PriceListDetail:PriceList"),dataField:"priceListCode",allowEditing:!1},{caption:e("EntityFieldName:MDMService:PriceListDetail:Item"),dataField:"itemCode",allowEditing:!1},{caption:"ItemDescription",allowEditing:!1},{caption:e("EntityFieldName:MDMService:PriceListDetail:UOM"),dataField:"uomCode",allowEditing:!1},{caption:e("EntityFieldName:MDMService:PriceListDetail:BasedOnPrice"),allowEditing:!1},{caption:e("EntityFieldName:MDMService:PriceListDetail:Price"),dataField:"price",dataType:"number",validationRules:[{type:"required"}]}]}).appendTo(t)}}}).dxDataGrid("instance")}));