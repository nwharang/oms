var uomGroupService=dMSpro.oMS.mdmSapService.uomGroups.uomGroup,uomGroupDetailService=dMSpro.oMS.mdmSapService.uomGroupDetails.uomGroupDetail,uomService=dMSpro.oMS.mdmSapService.uoms.uom;$((function(){var e=abp.localization.getResource("OMS"),t=new DevExpress.data.CustomStore({key:"id",load(e){e.withDetails=!1;const t=$.Deferred(),o={};return requestOptions.forEach((t=>{t in e&&isNotEmpty(e[t])&&(o[t]=JSON.stringify(e[t]))})),uomGroupService.getListDevExtreme(o).done((e=>{t.resolve(e.data,{totalCount:e.totalCount,summary:e.summary,groupCount:e.groupCount})})),t.promise()},byKey:function(e){if(0==e)return null;var t=new $.Deferred;return uomGroupService.get(e).done((e=>{t.resolve(e)})),t.promise()}}),o=new DevExpress.data.CustomStore({key:"id",load(e){const t=$.Deferred(),o={};return requestOptions.forEach((t=>{t in e&&isNotEmpty(e[t])&&(o[t]=JSON.stringify(e[t]))})),uomGroupDetailService.getListDevExtreme(o).done((e=>{let o=e.data.find((e=>e.altQty==e.baseQty));e.data=e.data.map((e=>({...e,baseUomCode:o?.uomCode}))),t.resolve(e.data,{totalCount:e.totalCount,summary:e.summary,groupCount:e.groupCount})})),t.promise()},byKey:function(e){if(0==e)return null;var t=new $.Deferred;return uomGroupDetailService.get(e).done((e=>{t.resolve(e)})),t.promise()}});new DevExpress.data.CustomStore({key:"id",loadMode:"raw",cacheRawData:!0,load(e){const t=$.Deferred(),o={};return requestOptions.forEach((t=>{t in e&&isNotEmpty(e[t])&&(o[t]=JSON.stringify(e[t]))})),uomService.getListDevExtreme(o).done((e=>{t.resolve(e.data,{totalCount:e.totalCount,summary:e.summary,groupCount:e.groupCount})})),t.promise()}});$("#gridUOMGroups").dxDataGrid({dataSource:t,remoteOperations:!0,showRowLines:!0,showBorders:!0,cacheEnabled:!0,allowColumnReordering:!0,rowAlternationEnabled:!0,allowColumnResizing:!0,columnResizingMode:"widget",columnAutoWidth:!0,filterRow:{visible:!0},groupPanel:{visible:!0},searchPanel:{visible:!0},columnMinWidth:50,columnChooser:{enabled:!0,mode:"select"},columnFixing:{enabled:!0},export:{enabled:!0},onExporting:function(e){const t=new ExcelJS.Workbook,o=t.addWorksheet("Data");DevExpress.excelExporter.exportDataGrid({component:e.component,worksheet:o,autoFilterEnabled:!0}).then((()=>{t.xlsx.writeBuffer().then((e=>{saveAs(new Blob([e],{type:"application/octet-stream"}),"UomGroup.xlsx")}))})),e.cancel=!0},headerFilter:{visible:!0},paging:{enabled:!0,pageSize:pageSize},pager:{visible:!0,showPageSizeSelector:!0,allowedPageSizes:allowedPageSizes,showInfo:!0,showNavigationButtons:!0},toolbar:{items:["exportButton","searchPanel"]},columns:[{type:"buttons",buttons:[],caption:e("Actions"),width:110,fixedPosition:"left"},{caption:e("MdmSAPService.Entity.Code"),dataField:"code",editorOptions:{maxLength:20},validationRules:[{type:"required"},{type:"pattern",pattern:"^[a-zA-Z0-9]{1,20}$",message:e("ValidateError:Code")}]},{caption:e("MdmSAPService.Entity.Name"),dataField:"name",validationRules:[{type:"required",message:"Name is required"}]}],masterDetail:{enabled:!0,template(t,a){$("<div>").dxDataGrid({dataSource:{store:o,filter:["uomGroupId","=",a.key]},remoteOperations:!0,showRowLines:!0,showBorders:!0,cacheEnabled:!0,allowColumnReordering:!0,rowAlternationEnabled:!0,allowColumnResizing:!0,columnResizingMode:"widget",columnAutoWidth:!0,export:{enabled:!0},onExporting:function(e){const t=new ExcelJS.Workbook,o=t.addWorksheet("Data");DevExpress.excelExporter.exportDataGrid({component:e.component,worksheet:o,autoFilterEnabled:!0}).then((()=>{t.xlsx.writeBuffer().then((e=>{saveAs(new Blob([e],{type:"application/octet-stream"}),"UomGroupDetail.xlsx")}))})),e.cancel=!0},searchPanel:{visible:!0},columnMinWidth:50,columnFixing:{enabled:!0},toolbar:{items:["addRowButton","exportButton","searchPanel"]},columns:[{type:"buttons",caption:e("Actions"),buttons:[],width:110,fixedPosition:"left"},{caption:e("EntityFieldName:MDMService:UOMGroupDetail:AltQty"),dataField:"altQty",validationRules:[{type:"required",message:"Alt quantity is required"}]},{caption:e("EntityFieldName:MDMService:UOMGroupDetail:AltUomCode"),dataField:"uomCode",validationRules:[{type:"required",message:"Alt UOM Code is required"}]},{caption:"=",alignment:"center",cellTemplate(e,t){$("<div>").append("<label>=</label>").appendTo(e)}},{caption:e("EntityFieldName:MDMService:UOMGroupDetail:BaseQty"),dataField:"baseQty",editorOptions:{min:2},validationRules:[{type:"required",message:"Base quantity is required"}]},{caption:e("EntityFieldName:MDMService:UOMGroupDetail:BaseUomCode"),calculateDisplayValue:"baseUomCode",validationRules:[{type:"required"}]},{caption:e("EntityFieldName:MDMService:UOMGroupDetail:Active"),dataField:"isActive",width:110,alignment:"center",dataType:"string",cellTemplate(e,t){$("<div>").append($("Y"==t.value?'<i class="fa fa-check" style="color:#34b233"></i>':'<i class= "fa fa-times" style="color:red"></i>')).appendTo(e)}}]}).appendTo(t)}}}).dxDataGrid("instance");initImportPopup("api/mdm-service/u-oMGroups","UOMGroups_Template","gridUOMGroups")}));